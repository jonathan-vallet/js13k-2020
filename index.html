<html><head><meta charset="utf-8"><title>Cardice</title><style type="text/css">.ls{position:relative;display:flex;flex-direction:column;align-items:center;justify-content:space-around;width:100%;min-height:100vh;background:#000;z-index:3}.ls:not(.-active){display:none}.ls:not(.-underBar){z-index:1;padding-top:70px}button{position:relative;display:inline-flex;align-items:center;justify-content:center;padding:10px 40px;max-width:350px;min-height:50px;background:#f92;border:0;color:#741;font-size:18px;cursor:pointer}button[disabled]{cursor:not-allowed;background:#666}[draggable=true]{cursor:grab}.d{display:grid;grid-template-columns:1fr;grid-template-rows:1fr;width:70px;height:70px;list-style-type:none;transform-style:preserve-3d;transition:transform 1.5s ease-out;margin:0 20px}.d.or{transition:transform 1.25s ease-out}.df{display:grid;grid-column:1;grid-row:1;grid-template-areas:"a b c" "d e f" "g h i";grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(3,1fr);height:100%;padding:8.75px;width:100%;background:#fff;border:1px solid #633}.dd{display:block;position:relative;width:14px;height:14px;align-self:center;justify-self:center;background-color:#633}.dd:before{content:"";width:14px;height:0;position:absolute;top:0;left:0;border-bottom:4.08879px solid #633;border-left:4.08879px solid #fff;border-right:4.08879px solid #fff}.dd:after{content:"";width:14px;height:0;position:absolute;bottom:0;left:0;border-top:4.08879px solid #633;border-left:4.08879px solid #fff;border-right:4.08879px solid #fff}[data-roll="1"]{transform:rotateX(360deg) rotateY(720deg) rotateZ(360deg)}[data-roll="2"]{transform:rotateX(450deg) rotateY(720deg) rotateZ(360deg)}[data-roll="3"]{transform:rotateX(360deg) rotateY(630deg) rotateZ(360deg)}[data-roll="4"]{transform:rotateX(360deg) rotateY(810deg) rotateZ(360deg)}[data-roll="5"]{transform:rotateX(270deg) rotateY(720deg) rotateZ(360deg)}[data-roll="6"]{transform:rotateX(360deg) rotateY(900deg) rotateZ(360deg)}.or[data-roll="1"]{transform:rotateX(-360deg) rotateY(-720deg) rotateZ(-360deg)}.or[data-roll="2"]{transform:rotateX(-270deg) rotateY(-720deg) rotateZ(-360deg)}.or[data-roll="3"]{transform:rotateX(-360deg) rotateY(-810deg) rotateZ(-360deg)}.or[data-roll="4"]{transform:rotateX(-360deg) rotateY(-630deg) rotateZ(-360deg)}.or[data-roll="5"]{transform:rotateX(-450deg) rotateY(-720deg) rotateZ(-360deg)}.or[data-roll="6"]{transform:rotateX(-360deg) rotateY(-900deg) rotateZ(-360deg)}[data-side="1"]{transform:rotate3d(0,0,0,90deg) translateZ(35px)}[data-side="2"]{transform:rotate3d(-1,0,0,90deg) translateZ(35px)}[data-side="3"]{transform:rotate3d(0,1,0,90deg) translateZ(35px)}[data-side="4"]{transform:rotate3d(0,-1,0,90deg) translateZ(35px)}[data-side="5"]{transform:rotate3d(1,0,0,90deg) translateZ(35px)}[data-side="6"]{transform:rotate3d(1,0,0,180deg) translateZ(35px)}.dd:last-child{grid-area:i}[data-side="4"] .dd:nth-child(2),[data-side="5"] .dd:nth-child(2),[data-side="6"] .dd:nth-child(2){grid-area:c}[data-side="6"] .dd:nth-child(3){grid-area:d}[data-side="1"] .dd,[data-side="3"] .dd:nth-child(2),[data-side="5"] .dd:nth-child(3){grid-area:e}[data-side="6"] .dd:nth-child(4){grid-area:f}[data-side="4"] .dd:nth-child(3),[data-side="5"] .dd:nth-child(4),[data-side="6"] .dd:nth-child(5){grid-area:g}#pa{position:absolute;bottom:50px;left:50px}#pa p{position:absolute;opacity:0;font-size:40px;transform:scale(0);transition:all .3s ease}#pa p.-loaded{opacity:1;transform:scale(1)}#oa{position:absolute;top:100px;right:50px}#oa p{position:absolute;opacity:0;font-size:40px;transform:scale(0);transition:all .3s ease}#oa p.-loaded{opacity:1;transform:scale(1)}.c{position:relative;transition:all .5s}.c.p{transform:translateY(-200px);opacity:0;pointer-events:none}.c.-active{transform:scale(1.2);z-index:2}.c b{white-space:nowrap;font-size:16px}.c i{display:inline-block;vertical-align:middle;width:18px;height:18px;border:1px dashed #fff;margin-right:2px;background:rgba(0,0,0,.2)}.co{width:160px;height:220px;border:2px solid #999;backface-visibility:hidden;perspective-origin:50% 50%;transform-style:preserve-3d;transform-origin:center}.co:before{content:'';display:block;position:absolute;top:10px;left:10px;right:10px;bottom:10px;background:rgba(255,255,255,.3);border:1px solid #111}.co.r2{border-color:#6ee}.co.r3{border-color:#fc5}.co.-w{background:#942}.co.-m{background:#18b}.co.-t{background:#449}.co.-a{background:#777}.co.-p{background:#a80}.co.-h{background:#162}.co.-mw{background:linear-gradient(to bottom,#18b 0,#942 100%)}.co.-tw{background:linear-gradient(to bottom,#449 0,#942 100%)}.co.-aw{background:linear-gradient(to bottom,#777 0,#942 100%)}.co.-pw{background:linear-gradient(to bottom,#a80 0,#942 100%)}.co.-hw{background:linear-gradient(to bottom,#162 0,#942 100%)}.co.-mt{background:linear-gradient(to bottom,#18b 0,#449 100%)}.co.-mp{background:linear-gradient(to bottom,#18b 0,#a80 100%)}.co.-hm{background:linear-gradient(to bottom,#162 0,#18b 100%)}.co.-at{background:linear-gradient(to bottom,#777 0,#449 100%)}.co.-pt{background:linear-gradient(to bottom,#a80 0,#449 100%)}.co.-ht{background:linear-gradient(to bottom,#162 0,#449 100%)}.co.-ah{background:linear-gradient(to bottom,#777 0,#162 100%)}.co.-hp{background:linear-gradient(to bottom,#162 0,#a80 100%)}.c__rarity{position:absolute;display:block;bottom:-7px;left:calc(50% - 7px);width:14px;height:14px;transform:rotate(-45deg) skew(15deg,15deg);border:2px solid #111}.c__rarity.r1{background:#38e}.c__rarity.r2{background:#e4f}.c__rarity.r3{background:#fc1}.ce{position:absolute;top:155px;transform:translateY(-50%);left:20px;right:20px;font-size:13px;line-height:1.5}.c__back{position:relative;display:flex;align-items:center;justify-content:center;width:160px;height:220px;border:1px solid #111;background-color:#4de;color:#2bc;overflow:hidden;font:bold 150px sans-serif}.c__back:before{content:'4';position:absolute;top:-55px;left:-20px}.c__back:after{content:'4';position:absolute;bottom:-35px;right:-10px}.cdl{position:absolute;top:40px;left:0;right:0;display:flex;justify-content:center}.cd{display:flex;justify-content:center;align-items:center;width:60px;height:60px;border:2px dashed #fff;margin:0 5px;font-size:14px;line-height:1.2;background:rgba(0,0,0,.2)}.cd.-active{background:rgba(0,0,0,.5)}.cList{display:grid;width:80%;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));grid-gap:20px}.cList .c{transition:transform .3s ease;perspective:1000px}.cList .c:hover{transform:scale(1.3);z-index:2}#md{position:absolute;bottom:50px;right:50px;width:160px;height:220px}#md .c{position:absolute;top:0;left:0}#mh{display:flex;justify-content:center;position:absolute;top:calc(50% - 110px);left:calc(50% - 420px);width:840px;height:220px}#mh .c:not(:last-child){margin-right:10px}*{margin:0;padding:0;color:#fff;font:small-caps 20px sans-serif}*,:after,:before{box-sizing:inherit}body{box-sizing:border-box;text-align:center}#ach{display:flex;justify-content:center}#ach>*{width:16.66667%;max-width:200px;transition:transform .3s ease;perspective:1000px}#ach>:hover{transform:scale(1.2);z-index:2}#ach canvas{width:100%}#etb{position:absolute;bottom:50px;right:300px}#dl{position:absolute;bottom:50px;left:300px;width:calc(100% - 800px);display:flex;align-items:center;justify-content:center;flex-wrap:wrap;perspective:600px}#rewardCardList{width:490px}#sg{background:#0bb}#game-background{position:absolute;top:0;left:0;width:100%;height:100%;background:#0bb}.c-life{position:absolute}.c-life[data-p="1"]{bottom:190px;left:220px}.c-life[data-p="2"]{top:120px;right:220px}.c-life[data-p="2"] .c-life__bar{transform:scaleX(-1)}.c-life p{position:absolute;top:0;left:0;bottom:0;width:0;background:#44c;transition:width .5s ease}.c-life :nth-child(2){background:#c44;transition-duration:.3s;transition-delay:1.3s}.c-life :nth-child(3){background:#4c4;transition-duration:1s;transition-delay:.5s}.c-life__bar{position:relative;width:400px;height:40px;background:#666;border:1px solid #000}#sm{background:#0bb}#mw{position:relative}#mw p{position:absolute;padding:5px;font-size:20px;min-width:41px;text-align:center;transition:1s ease;border-radius:50%;border:2px solid transparent}#mw p:last-child{font-size:60px}#mw p.-active{cursor:pointer;animation:2s ease infinite a;transform:scale(1.6)}#mw p.-active:hover{background:rgba(0,0,0,.3)}#mw p.-selected{border:2px solid #000;border-color:#000;transform:scale(1.8)}@keyframes a{50%{transform:scale(2.2)}}.a-title{position:relative;margin-bottom:50px;padding:10px 60px;background:#f92;box-shadow:0 16px 0 -8px;color:#741;font:bold small-caps 40px serif}.a-title:after,.a-title:before{content:'';width:90px;height:100%;position:absolute;top:50%;background:#f92;box-shadow:inherit;z-index:-1}.a-title:before{left:-55px}.a-title:after{right:-55px}#c-userBar{position:fixed;top:0;left:0;right:0;height:70px;display:flex;justify-content:space-between;align-items:center;background:#333;z-index:2}#c-userBar ul{display:flex}#c-userBar li{display:block;padding:20px}</style></head><body><div class="ls -underBar -active" id="screen-menu"><p class="a-title">Cardice</p><button class="jsl" data-sc="sg" id="cb">Continue game</button> <button class="jsl" data-sc="scc">New game</button><div id="acl" class="cList" style="display: dnone"></div></div><div class="ls -underBar" id="scc"><p>Create you hero: pick up 2 classes</p><div id="ach" data-t0="w" data-t1="w"></div><p>You are:</p><div id="ma"></div><button class="jsl" data-sc="sm">Start game</button></div><div class="ls" id="sm"><div id="mw"><canvas id="map"></canvas></div></div><div id="c-userBar"><ul><li id="playerClass"></li><li id="playerLife"></li><li id="playerGold"></li><li id="playerFloor"></li></ul><p><button class="jsl" data-sc="screen-my-deck">My deck</button> <button class="jsl" data-sc="screen-settings">Settings</button></p></div><div class="ls" id="sg"><canvas id="game-canvas"></canvas><div class="c-life" data-p="1"><div class="c-life__bar"><p></p><p></p><p></p></div><b>100/100</b></div><div class="c-life" data-p="2"><div class="c-life__bar"><p></p><p></p><p></p></div><b>100/100</b></div><div id="mh"></div><div id="md"></div><div id="pa"></div><div id="oa"></div><div id="dl"></div><button type="button" id="etb">End turn</button></div><div class="ls" id="screen-my-deck"><p class="a-title">My deck</p><div id="mcl" class="cList"></div><button class="jsl" data-sc="sg">Back</button></div><div class="ls" id="screen-reward"><p class="a-title">Some rewards!</p><p class="c-reward__gold">💰: 50</p><button class="jsl" data-sc="screen-card-add">Add a card to your deck</button></div><div class="ls" id="screen-heal"><p class="a-title">You are healed!</p><p class="c-reward__gold">You got 30% of your missing 💖.</p><button class="jsl" data-sc="sm">Continue</button></div><div class="ls" id="screen-card-add"><p class="a-title">Choose a card</p><div id="rewardCardList" class="cList"></div><button class="jsl" data-sc="sm">Skip</button></div><script>!function(){var e=e=>document.getElementById(e),t=e=>document.querySelector(e),a=e=>document.querySelectorAll(e),r=e=>document.createElement(e),i=()=>Math.random(),n=e=>JSON.parse(window.localStorage.getItem(e)),l=(e,t)=>window.localStorage.setItem(e,JSON.stringify(t)),d=Math.PI,o=2*d;function s(e){return e[~~(i()*e.length)]}function c(e,t){return~~(i()*(t-e+1))+e}var f={w:"#942",m:"#18b",t:"#449",a:"#777",p:"#a80",h:"#162"};const h={w:"Warrior",m:"Mage",t:"Thief",a:"Assassin",p:"Protector",h:"Heal",mw:"Battlemage",tw:"Rogue",aw:"Slayer",pw:"Paladin",hw:"Templar",mt:"Warlock",am:"Dreamkiller",mp:"Guardian",hm:"Runemaster",at:"Ninja",pt:"Brigand",ht:"Trickster",ap:"Ranger",ah:"Avenger",hp:"Sage"},u={m:"💀",e:"👿",b:"😈",t:"💰",r:"❓",s:"🤑",h:"💖"};var p=e("acl"),m=e("mcl"),g=e("ach"),b=e("ma"),w=e("map"),v=e("cb"),y=e("pa"),$=e("oa"),T=e("md"),L=e("mh"),x=e("etb"),k=e("mw"),S=e("rewardCardList"),M=e("sg");let X=e("dl");var C=[],A=[],_=[],E=12;const H=130;var P=[];let j={set:function(t,a,r){t[a]=r,1==t.id?(e("playerClass").innerText=N(q.c),e("playerLife").innerText=`💖 ${q.l}/${q.m}`,e("playerGold").innerText=`💰 ${q.g}`,e("playerFloor").innerText=`👣 ${q.f}`,l("player",t)):l("opponent",t)}},q=new Proxy({id:1,m:100,l:0,s:""},j),D=new Proxy({id:2,m:15,l:0},j),I=null;var O={w1:{d:"+4",e:"damage|X-2",r:1},w2:{d:"-3",e:"damage|X",r:1},w3:{d:"+4",e:"damage|X,6:stun|1",r:2},w4:{d:"6",e:"damage|X+2",r:2},w5:{d:"-4",e:"updie|X+2",r:2},w6:{d:"odd",e:"damage|3,stun|6",r:1},w7:{d:"even",e:"damage|3,stun|6",r:1},m1:{d:"5",e:"damage|5,fire|1",r:2},m2:{d:"-2",e:"fire|X",r:1},t1:{d:"6",e:"split|2",r:3},a1:{d:"double|double",e:"poison|3",r:3},p1:{d:"|",e:"protection|X",r:1},h1:{d:"odd",e:"heal|X-1",r:1},mw1:{d:"",e:"damage|X + 2",r:1},tw1:{d:"",e:"damage|X",r:1},aw1:{d:"",e:"damage|X",r:1},pw1:{d:"",e:"odd:protection|X,even:damage|X",r:1},hw1:{d:"",e:"odd:damage|X,even:heal|X",r:1},mt1:{d:"",e:"damage|X",r:1},am1:{d:"",e:"damage|X",r:1},mp1:{d:"",e:"damage|X",r:1},hm1:{d:"",e:"damage|X",r:1},at1:{d:"",e:"damage|X",r:1},pt1:{d:"",e:"odd:heal|X,even:protection|X",r:1},ht1:{d:"",e:"odd:poison|X,even:heal|X",r:1},at1:{d:"",e:"damage|X",r:1},ah1:{d:"",e:"damage|X",r:1},hp1:{d:"",e:"damage|X",r:1}},W=1;function F(e,t){let a=B(e,t);b.innerHTML="",b.append(a),q.c=e+t}function B(e,t){let a=r("div"),i=r("canvas"),n=i.getContext("2d");return i.width=200,i.height=200,function(e,t,a,r){const i=e.width;var n=t.createLinearGradient(.2*i,.2*i,.6*i,i);n.addColorStop(0,a),n.addColorStop(1,r),R(t,n,.5*i,.6*i,.4*i,0,o),R(t,"#b87",.45*i,.5*i,.25*i,0,o),R(t,"#124",i/1.7,i/2.2,i/35,0,o),R(t,"#124",i/2.2,i/2.2,i/35,0,o)}(i,n,f[e],f[t]),function(e,t,a){const r=e.width;switch(a){case"w":R(t,"#999",.45*r,.5*r,.26*r,1.05*d,1.9*d),z(t,"#999",.33*r,.3*r,.2*r,.2*r,.28*r,.4*r),z(t,"#999",.56*r,.3*r,.7*r,.2*r,.62*r,.4*r);break;case"m":z(t,"#138",.2*r,.3*r,.75*r,.38*r,.5*r,.1*r),z(t,"#138",.28*r,.3*r,.7*r,.38*r,.52*r,0*r);break;case"t":R(t,"#124",.45*r,.5*r,.25*r,1.9*-d,1.1*-d),z(t,"#124",.55*r,.5*r,.7*r,.58*r,.2*r,.58*r);break;case"a":R(t,"#333",.45*r,.5*r,.25*r,2*d,d);break;case"p":R(t,"#999",.45*r,.5*r,.3*r,1.05*d,1.95*d),R(t,"#999",.45*r,.5*r,.27*r,2*d,d);break;case"h":z(t,"#242",.2*r,.3*r,.75*r,.38*r,.5*r,.1*r),z(t,"#242",.28*r,.3*r,.7*r,.38*r,.52*r,0*r)}}(i,n,e),function(e,t,a){const r=e.width;switch(a){case"w":z(t,"#999",.75*r,.47*r,.9*r,.4*r,.86*r,.6*r),z(t,"#421",.6*r,r,.8*r,.4*r,.68*r,r);break;case"m":z(t,"#421",.6*r,r,.8*r,.4*r,.68*r,r),R(t,"#822",.8*r,.42*r,.1*r,0,o);break;case"t":z(t,"#999",.6*r,r,.72*r,.6*r,.68*r,r);break;case"a":R(t,"#111",.7*r,.8*r,.1*r,0,o),z(t,"#111",.7*r,.6*r,.65*r,.8*r,.75*r,.8*r);break;case"p":R(t,"#444",.67*r,.75*r,.14*r,0,o),z(t,"#444",.7*r,.95*r,.42*r,.65*r,.88*r,.6*r);break;case"h":z(t,"#421",.6*r,r,.8*r,.4*r,.68*r,r),R(t,"#481",.8*r,.42*r,.1*r,0,o)}}(i,n,t),Q(a),a.append(i),a.insertAdjacentHTML("beforeend",`<p>${N(e+t)}</p>`),a}function N(e){return h[K(e)]}function R(e,t,a,r,i,n,l,d){e.fillStyle=t,e.beginPath(),e.arc(a,r,i,n,l,d),e.fill()}function z(e,t,a,r,i,n,l,d){e.fillStyle=t,e.beginPath(),e.moveTo(a,r),e.lineTo(i,n),e.lineTo(l,d),e.fill()}function G(e,t,a){t.innerHTML="";for(const r of Object.values(e)){let e=Y(r);Q(e),t.append(e),a&&(e.style.cursor="pointer",e.onclick=(()=>{a(r)}))}}function J(e){q.d.push(e),he("sm")}function Y(e,t=-1){let a=O[e],i=`<div class="co -${K(e)} r${a.r}"><div class="cdl">`;a.d.split("|").forEach((e,a)=>{i+=function(e,t=-1,a){let r=t>=0?`data-hand="${t}"`:"",i=e.match(/([-+*]?)([0-9])/),n=e;if(i){let e="";switch(i[1]){case"-":e="max<br/>";break;case"+":e="min<br/>"}n=e+i[2]}return`<p class="cd" ${r} data-die="${a}">${n}</p>`}(e,t,a)}),i+=`</div><p class="ce">${function(e,t){let a="";return e.split(",").forEach((e,t)=>{a+=t>0?"<br>":"";let r=e.split("|"),i=r[0].split(":"),n=r[1].replace("X","<i></i>"),l=i.length>1?i[0]:"",d=i[i.length-1];switch(a+=l?`${l}: `:"",d){case"damage":a+=`Do 💢<b>${n}</b> damage`;break;case"poison":a+=`Do 🤢<b>${n}</b> poison`;break;case"stun":a+="Stun 😵 a die";break;case"updie":a+=`Increase die value of <b>${n}</b>`;break;case"fire":a+="Fire 🔥 a die";break;case"heal":a+=`Heal ➕<b>${n}</b> life points`;break;case"split":a+=`Split die in <b>${n}</b>`;break;case"protection":a+=`Add 🛡 <b>${n}</b> shield`;break;case"freeze":a+="Freeze ❄ a die"}}),a}(a.e)}</p>`;let n=r("div");return n.classList.add("c"),t>=0&&(n.dataset.hand=t),n.innerHTML=i,n}function K(e){let t=e.replace(/\d+/,"");return t.length<2||t[0]==t[1]?t[0]:t.split("").sort().join("")}function Q(e){e.onmousemove=(t=>{let a=t.currentTarget.getBoundingClientRect(),r=Math.max(0,t.pageX-~~a.left),i=Math.max(0,t.pageY-window.scrollY-~~a.top),n=~~a.width,l=~~a.height,d=n/2-r,o=l/2-i,s=Math.sqrt(Math.pow(d,2)+Math.pow(o,2)),c=s/Math.sqrt(Math.pow(n/2,2)+Math.pow(l/2,2));e.firstChild.style.transform=`rotate3d(${o/s}, ${-d/s}, 0, ${20*c}deg)`,e.firstChild.style.filter=`brightness(${1.2-i/l/2})`}),e.onmouseleave=(()=>{e.firstChild.style.transform="",e.firstChild.style.filter=""})}function U(e){e.classList.add("p"),function(e){let t=A[e.dataset.hand],a=e.querySelector("[data-die]").dataset.value;O[t].e.split(",").forEach((e,t)=>{let r=e.split("|"),i=function(e,t){let a=0,r=1;for(let i of e)"X"==i&&(a+=t),"-"==i&&(r=-1),"*"==i&&(r=t),isNaN(i)||(a+=r*+i);return a}(r[1],+a);switch(r[0]){case"damage":se(D,-i);break;case"stun":break;case"heal":se(q,i);case"updie":V(i)}})}(e),setTimeout(()=>{me(e.dataset.hand)},500)}function V(e){let t=r("ol");t.classList.add("d"),i()>.5&&t.classList.add("or");let a="",n="";for(let e=1;e<7;++e)a+=`<li class="df" data-side="${e}">${n+='<span class="dd"></span>'}</li>`;t.innerHTML=a,t.id=`die-${X.childElementCount}`,t.setAttribute("data-roll",e||c(1,6)),t.ondragstart=(e=>{I=e.target.parentNode.id,ee(e.currentTarget.getAttribute("data-roll"),e=>{e.classList.add("-active")})}),t.ondragend=(e=>{ee(e.currentTarget.getAttribute("data-roll"),e=>{e.classList.remove("-active")})}),X.append(t),e&&Z(t,e)}function Z(e,t){t||(e.classList.toggle("or"),t=c(1,6)),e.setAttribute("data-roll",t);let a=e.querySelector("[draggable]");a&&a.removeAttribute("draggable"),e.querySelector(`[data-side="${t}"]`).setAttribute("draggable","true")}function ee(e,t){A.forEach((a,r)=>{O[a].d.split("|").forEach((a,i)=>{if(te(r,i,e)){let e=L.querySelector(`[data-hand="${r}"] [data-die="${i}"]`);t(e)}})})}function te(e,t,a){let r=O[A[e]].d;var i=r.match(/([-+*]?)([0-9])/);if(i)switch(r=i[2],i[1]){case"-":return a<=r;case"+":return a>=r;default:return r==a}return"double"===r||("odd"===r?a%2:"even"===r?a%2==0:void 0)}var ae=e("game-canvas");let re=[],ie=[],ne=Date.now(),le=50;function de(e){requestAnimationFrame(de);let t=Date.now(),a=t-ne;a>le&&(ne=t-a%le,function(){let e=ae.getContext("2d");e.clearRect(0,0,ae.width,ae.height),e.fillStyle="#cee",e.beginPath(),e.rect(0,0,ae.width,200),e.fill(),e.fillStyle="#ffa",e.beginPath(),e.arc(ae.width-400,200,180,d,2*d),e.fill(),oe(e,"#cff",ie,260,240,280),oe(e,"#ffa",re,200,190,210),e.fillStyle="#cff",e.fill(new Path2D("M661.71 320.09h367.18v-5.44l-7.62-32.24-29.53-26.23-272.72 3.07-57.31 55.4z")),e.fillStyle="#ffa",e.fill(new Path2D("M661.71 314.65l101.49-3.32 76.33 3.32 68.8-2.63 70.83-1.39 49.73 4.02-7.62-37.67-29.53-26.23-272.72 3.06-41.75 27.15z")),e.fillStyle="#7e7",e.fill(new Path2D("M679.77 264.17l20.67 5.64 70.05 5.87 97.65-6.79 92.7 3.4 36.81-6.24 12.15-15.3 9.37-35.97-31.59-28.91-37.61-18.06-110.84-15.06-84.92 6.8-49.53 22.66-33.26 33.99z"))}())}function oe(e,t,a,r=0,i,n){e.beginPath(),e.fillStyle=t,e.moveTo(0,ae.height),e.lineTo(0,ae.height-r),a.forEach(t=>{t.y+=.2*t.direction,(t.y<=i||t.y>=n)&&(t.y=Math.max(i,Math.min(t.y,n)),t.direction*=-1),e.lineTo(t.x,ae.height-t.y)}),e.lineTo(ae.width,ae.height-r),e.lineTo(ae.width,ae.height),e.fill()}function se(e,i){let n=Math.max(0,Math.min(100,e.l+~~i));!function(e,t){let a=[];for(var i=0;i<~~(1+Math.abs(e-t.l)/10);++i){var n=r("p");n.innerText=e>t.l?"➕":"💢",n.style.top=`${c(20,150)}px`,n.style.left=`${c(20,150)}px`,1===t.id?y.append(n):$.append(n),n.offsetWidth,n.classList.add("-loaded"),a.push(n)}setTimeout(()=>{for(var e of a)e.remove()},500)}(n,e),e.l=n,t(`.c-life[data-p="${e.id}"] b`).innerText=`${e.l}/${e.m}`,[...a(`.c-life[data-p="${e.id}"] p`)].forEach(t=>{t.style.width=`${~~(e.l/e.m*100)}%`}),n<=0&&ue()}function ce(){P.push([{e:"m"},{e:"m"},{e:"m"}]);let e=0;for(;++e<E;)P.push(fe());P.push([{e:"h"},{e:"h"},{e:"h"}]),P.push([{e:"b"}]),function(){for(let t in P){let a=P[t=+t],r=P[t+1];if(r){let t=0;for(let n in a){var e=a[n=+n];if(e.l=[],n>=a.length-1)for(;t<r.length;)e.l.push(t++);else e.l.push(t),r.length>t+1&&(++t,i()>.65&&e.l.push(t))}}}}(),function(){let e=w.getContext("2d"),t=H,a=[],r=[];w.width=900,w.height=t*(E+3),e.fillStyle="#7e7",e.fillRect(0,0,w.width,w.height);for(let[e,n]of Object.entries(P)){e=+e;for(let[l,d]of Object.entries(n)){let o=~~(150*((l=+l)+3.2+.6*i()-n.length/2));3==n.length&&(0==l&&(o-=70),2==l&&(o+=70));let s=~~(w.height-t*(e+1.1-.4*i())),c=e==P.length-1?60:25;d.x=o,d.y=s;let f="sg";"h"==d.e&&(f="screen-heal"),k.insertAdjacentHTML("beforeend",`<p style="left:${o-c}px;top:${s-c}px" data-floor="${e}" data-x="${l}" class="jsl" data-sc="${f}">${u[d.e]}</p>`),0===l&&a.push({x:o,y:s}),l===n.length-1&&r.push({x:o,y:s})}}for(let[t,a]of Object.entries(P)){let r=P[(t=+t)+1];if(r)for(let[t,i]of Object.entries(a)){t=+t;for(let t in i.l){let a=r[i.l[t]];e.beginPath(),e.lineWidth=5,e.strokeStyle="#ffa",e.setLineDash([10,5]),e.moveTo(i.x+10*t-10,i.y-25),e.lineTo(a.x-12,a.y+10),e.stroke()}}}["#ffa","#cff","#7cc","#0bb"].forEach((t,i)=>{for(let n=-1;n<=1;n+=2){let l=a,d=0;n>0&&(l=r,d=w.width),e.beginPath(),e.fillStyle=t,e.moveTo(l[0].x+c(-5,5)-8*i,2500);for(let t in l){let a=8*(4-i)+(0==i?50+(t==P.length-1?200:0):0),r=l[t].x+n*(a-c(0,5)),d=l[t].y+c(-5,5);e.lineTo(r,d),l[t].x=r,l[t].y=d}e.lineTo(l[l.length-1].x+c(-5,5)+n*i*5,0),e.lineTo(d,0),e.lineTo(d,w.height),e.fill()}})}()}function fe(){var e=c(3,4),t=[];let a=0;for(;a++<e;)t.push({e:s(Array.from("mmmmmeetrrrsh"))});return t}function he(r){if(document.querySelector(".ls.-active").classList.remove("-active"),e(r).classList.add("-active"),"sm"==r){if("map"!=q.f)if(q.s="map",0==q.f)[...a(`[data-floor="${q.f}"]`)].forEach(e=>{e.classList.add("-active")});else{$lastFloor=t(`[data-floor="${q.f-1}"].-selected`);for(let e of P[q.f-1][$lastFloor.getAttribute("data-x")].l)t(`[data-floor="${q.f}"][data-x="${e}"]`).classList.add("-active")}setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight-window.innerHeight-(q.f-1)*H,behavior:"smooth"})},500)}var n;"sg"==r&&"game"!=q.s&&(q.s="game",++q.f,q.t=0,0==q.f&&se(q,q.m),_=[...q.d],A=[],C=[],L.innerHTML="",se(q,q.m),n=Object.keys(f),D.c=n[c(0,n.length-1)]+n[c(0,n.length-1)],$.firstChild&&$.firstChild.remove(),$.append(B(D.c[0],D.c[1])),D.m=2,se(D,D.m),we(),be(),pe(),function(){let e=q.c;y.firstChild&&y.firstChild.remove(),y.append(B(e[0],e[1]))}(),function(){ae.width=M.offsetWidth,ae.height=M.offsetHeight-70;for(let e=0;e<=ae.width;e+=c(ae.width/7,ae.width/9)){let t=c(190,210);re.push({x:e,y:t,direction:i()>.5?1:-1}),ie.push({x:e,y:t+c(40,60),direction:i()>.5?1:-1})}requestAnimationFrame(de)}()),"screen-my-deck"==r&&G(q.d,m),"screen-heal"==r&&(++q.f,se(q,.3*q.m)),"screen-card-add"==r&&function(){let e=[],t=[],a=[];for(cardId in O)K(cardId)==q.c[0]&&e.push(cardId),K(cardId)==q.c[1]&&t.push(cardId),[q.c[0],q.c[1],K(q.c)].indexOf(K(cardId))>=0&&a.push(cardId);let r=s(e),i=s(t=t.filter(e=>e!=r));a=a.filter(e=>[r,i].indexOf(e)<0),G([r,i,s(a)],S,J)}(),"scc"==r&&(F("w","w"),q.g=100,q.f=0,q.d=["w1","w1","w2","w2","w3","w4","w5","w6","w7","m2","mw1"]),"screen-reward"==r&&(q.g+=50)}function ue(){q.l<=0?console.log("you lose"):he("screen-reward")}function pe(){++q.t,X.innerHTML="";for(let e=0;e<Math.min(5,q.t);++e)V();document.body.offsetWidth,[...a(".d")].forEach(e=>{Z(e)}),setTimeout(()=>{!function(){for(var e=0;e<5;++e)ge(e)}()},800)}function me(e){C.push(A[e]),A.splice(e,1),L.removeChild(L.children.item(e)),[...L.querySelectorAll(".c")].forEach((e,t)=>{e.dataset.hand=t})}function ge(t){setTimeout(()=>{_.length||(_=C,C=[],we(),be()),_.length&&function(t){A.push(_[0]),_.shift();let a=Y(t,L.childElementCount);a.ondragenter=(t=>{var a=t.target;let r=e(I),i=r.dataset.roll,n=a.closest(".c"),l=n.dataset.dragCounter||0;n.dataset.dragCounter=++l,a.classList.contains("cd")||(a=n.querySelector(".cd")),te(n.dataset.hand,a.dataset.dice,i)&&n.classList.add("-active")}),a.ondragleave=(e=>{let t=a.dataset.dragCounter||0;a.dataset.dragCounter=--t,a.dataset.dragCounter<=0&&a.classList.remove("-active")}),a.ondrop=(t=>{var r=t.target;let i=e(I),n=i.dataset.roll;r.classList.contains("cd")||(r=r.closest(".c").querySelector(".cd")),te(a.dataset.hand,r.dataset.dice,n)&&(i.remove(),r.dataset.value=n,U(a))}),a.ondragover=(e=>{e.preventDefault()}),L.append(a),T.removeChild(T.lastElementChild)}(_[0])},100*t)}function be(){T.innerHTML="",_.forEach((e,t)=>{let a=r("div");a.classList.add("c"),a.innerHTML='<p class="c__back">0</p>',T.append(a),a.style.transition=`all ${t/20}s linear`,a.offsetWidth,a.style.transform=`translate(${2*t}px, ${2*t}px)`})}function we(){for(let e=_.length-1;e>0;e--){const t=c(0,e);[_[e],_[t]]=[_[t],_[e]]}}!function(){for(const e of Object.keys(O)){let t=Y(e);Q(t),p.append(t)}}(),ce(),function(){for(const[e,t]of Object.entries(f)){let t=B(e,e);t.setAttribute("data-type",e),t.onclick=(()=>{var e=t.getAttribute("data-type");g.setAttribute(`data-t${++W%2}`,e),F(g.dataset.t0,g.dataset.t1),t.classList.add(`-choice${W%2}`)}),g.append(t)}}(),document.body.onclick=(e=>{if(e.target.classList.contains("jsl")){if(e.target.hasAttribute("data-floor")){let t=e.target.getAttribute("data-floor");if(!e.target.classList.contains("-active"))return;[...a(`[data-floor="${t}"]`)].forEach(e=>{e.classList.remove("-active")}),e.target.classList.add("-selected")}he(e.target.getAttribute("data-sc"))}}),x.onclick=(()=>{(function(){for(var e=0;e<A.length;++e)setTimeout(()=>{me(0)},100*e)})(),setTimeout(()=>{pe()},500)}),n("avatar")||v.setAttribute("disabled","disabled")}();</script></body></html>